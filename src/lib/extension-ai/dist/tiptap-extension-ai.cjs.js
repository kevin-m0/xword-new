"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@tiptap/core"),e=require("@tiptap/pm/state"),n=require("@tiptap/pm/view"),o=require("@tiptap/pm/transform");const i=t.Mark.create({name:"aiMark",addOptions:()=>({HTMLAttributes:{class:"tiptap-ai-insertion"}}),parseHTML:()=>[{tag:"span",getAttrs:t=>t.classList.contains("tiptap-ai-insertion")&&null}],renderHTML({HTMLAttributes:e}){return["span",t.mergeAttributes(this.options.HTMLAttributes,e),0]},addCommands(){return{setAiMark:()=>({commands:t})=>t.setMark(this.name),toggleAiMark:()=>({commands:t})=>t.toggleMark(this.name),unsetAiMark:()=>({commands:t})=>t.unsetMark(this.name)}}}),r=(t,e,o,i)=>t.map((t=>[n.Decoration.inline(t.pos,t.pos+t.node.nodeSize,{class:"tiptap-ai-prompt"}),n.Decoration.node(t.pos,t.pos+t.node.nodeSize,{class:"tiptap-ai-suggestion","data-prompt":`${o}`,"data-suggestion":i})])).flat();let s;const a=()=>{null==s||s.abort()},l=async(t,e,n)=>{s=new AbortController;const o=t.extensionManager.extensions.find((t=>"ai"===t.name||"aiAdvanced"===t.name));if(!o)throw new Error("AI extension not found.");const{aiStreamResolver:i}=o.options,a=(e.length>3?e.slice(e.length-3):e).filter((t=>t.node.textContent)).map((t=>t.node.textContent)).join(" ").trim()||"",{inputLength:l,modelName:c}=n,d=a.slice(a.length-l,a.length).trim(),p=t.view.state.doc;if(!d.length)return;(async({text:n,aborter:s})=>{let a="";try{const l=await i({action:"autocomplete",text:n,textOptions:{modelName:c},extensionOptions:o.options,aborter:s});if(!l)return;const d=l.getReader(),u=new TextDecoder;let h=!1;for(;!h;){const{value:n,done:o}=await d.read(),i=u.decode(n,{stream:!0});h=o,a+=i;const s=r([e[e.length-1]],p.nodeSize,e[e.length-1].node.textContent,`${a||""}`),l=t.view.state.tr.setMeta("asyncDecorations",s);t.view.dispatch(l)}h=!0}catch(t){console.error(t),o.options.onError&&o.options.onError(t)}})({text:d,aborter:s})},c=({editor:o,options:i,pluginKey:r="AiAutocompletionPlugin"})=>new e.Plugin({key:new e.PluginKey(r),state:{init:()=>n.DecorationSet.empty,apply(t,e,o,i){const{doc:r,docChanged:s}=t,l=t.getMeta("asyncDecorations");return void 0===l&&!s&&o.selection.eq(i.selection)?e:(o.selection.eq(i.selection)||a(),e=e.map(t.mapping,t.doc),n.DecorationSet.create(r,l||[]))}},props:{decorations(t){return this.getState(t)},handleKeyDown(e,n){const r=this.getState(e.state),[s,c]=e.state.tr.getMeta("asyncDecorations")||(null==r?void 0:r.find())||[],d=()=>{const t=e.state.tr.setMeta("asyncDecorations",[]);null==r||r.remove([s]),null==r||r.remove([c]),e.dispatch(t)},p=!!s;switch(n.key){case"Escape":case"Enter":p&&(a(),d());break;case i.trigger:if(n.preventDefault(),n.stopPropagation(),p)((t,e)=>{const n=e.type.attrs["data-suggestion"];t.chain().focus().insertContentAt(e.to-1,n,{updateSelection:!0}).focus().run()})(o,c),a();else{const n=0,r=o.state.selection.to,s=t.findChildrenInRange(e.state.doc,{from:n,to:r},(t=>t.isTextblock)),a=s[s.length-1];r===a.pos+a.node.nodeSize-1&&l(o,s,i)}break;default:a(),d()}return!1}}}),d=async({action:t,text:e,textOptions:n,extensionOptions:o,aborter:i})=>{var r,s;const{appId:a,token:l,baseUrl:c}=o,d=null!=c?c:b;let p={method:"POST",headers:{accept:"application/json","content-type":"application/json","X-App-Id":a,Authorization:`Bearer ${l}`},body:JSON.stringify({...n,text:e,stream:!0})};i&&i instanceof AbortController&&(p={...p,signal:i.signal});const u=await fetch(`${d}/text/${t}?stream=1`,p);if(!u.ok){const t=await u.json();if((null==t?void 0:t.error)instanceof Object)throw new Error(`${null===(r=null==t?void 0:t.error)||void 0===r?void 0:r.status} ${null===(s=null==t?void 0:t.error)||void 0===s?void 0:s.message}`);throw new Error(`${null==t?void 0:t.error} ${null==t?void 0:t.message}`)}return null==u?void 0:u.body},p=({props:t,action:e,textOptions:n,extensionOptions:o,fetchDataFn:i})=>async()=>{const{editor:r}=t,{state:s}=r,a={collapseToEnd:!0,plainText:!1,...n},{selection:l,selection:{from:c,to:p}}=s,u=(null==n?void 0:n.text)||s.doc.textBetween(c,p," ");if(!u)return!1;o.onLoading&&o.onLoading();let h=c;a.append&&(h=p);try{const t=await i({action:e,text:u,textOptions:a,extensionOptions:o,defaultResolver:d}),n=await(null==t?void 0:t.getReader());let s=!1;if(!n)throw new Error("[tiptap-ai] fetchDataFn doesn’t return stream.");for(a.append||r.chain().focus().deleteRange(l).run();!s;){const{done:t,value:e}=await n.read();s=t,t&&(r.commands.focus(),r.chain().focus().unsetAiMark().run(),o.onSuccess&&o.onSuccess(),o.collapseToEnd||a.collapseToEnd||r.commands.setTextSelection({from:c,to:h}));const i=new TextDecoder("utf-8").decode(e);r.chain().focus().setAiMark().insertContentAt(h,i).run(),h+=i.length}}catch(t){return o.onError&&o.onError(t),!1}return!0},u=({dispatch:n,tr:i,oldSelection:r})=>{if(n){const s=((t,n,i)=>{const r=t.steps.length-1;if(r<n)return-1;const s=t.steps[r];if(!(s instanceof o.ReplaceStep||s instanceof o.ReplaceAroundStep))return-1;const a=t.mapping.maps[r];let l=0;return a.forEach(((t,e,n,o)=>{0===l&&(l=o)})),e.Selection.near(t.doc.resolve(l),i)})(i,i.steps.length-1,-1);if(-1!==s){const o=((n,o,i)=>{const{doc:r}=n,s=e.TextSelection.atStart(r).from,a=e.TextSelection.atEnd(r).to,l=t.minMax(i.from,s,a),c=t.minMax(o.to,s,a);return e.TextSelection.create(r,l,c)})(i,s,r);return i.setSelection(o),n(i),!0}}return!1};function h(t,e,n){for(let o=0;;o++){if(o==t.childCount||o==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(o),r=e.child(o);if(i!=r){if(!i.sameMarkup(r))return n;if(i.isText&&i.text!=r.text){for(let t=0;i.text[t]==r.text[t];t++)n++;return n}if(i.content.size||r.content.size){let t=h(i.content,r.content,n+1);if(null!=t)return t}n+=i.nodeSize}else n+=i.nodeSize}}function m(t,e,n,o){for(let i=t.childCount,r=e.childCount;;){if(0==i||0==r)return i==r?null:{a:n,b:o};let s=t.child(--i),a=e.child(--r),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:o};if(s.isText&&s.text!=a.text){let t=0,e=Math.min(s.text.length,a.text.length);for(;t<e&&s.text[s.text.length-t-1]==a.text[a.text.length-t-1];)t++,n--,o--;return{a:n,b:o}}if(s.content.size||a.content.size){let t=m(s.content,a.content,n-1,o-1);if(t)return t}n-=l,o-=l}else n-=l,o-=l}}class f{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let e=0;e<t.length;e++)this.size+=t[e].nodeSize}nodesBetween(t,e,n,o=0,i){for(let r=0,s=0;s<e;r++){let a=this.content[r],l=s+a.nodeSize;if(l>t&&!1!==n(a,o+s,i||null,r)&&a.content.size){let i=s+1;a.nodesBetween(Math.max(0,t-i),Math.min(a.content.size,e-i),n,o+i)}s=l}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,n,o){let i="",r=!0;return this.nodesBetween(t,e,((s,a)=>{let l=s.isText?s.text.slice(Math.max(t,a)-a,e-a):s.isLeaf?o?"function"==typeof o?o(s):o:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&l||s.isTextblock)&&n&&(r?r=!1:i+=n),i+=l}),0),i}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,n=t.firstChild,o=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(o[o.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)o.push(t.content[i]);return new f(o,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let n=[],o=0;if(e>t)for(let i=0,r=0;r<e;i++){let s=this.content[i],a=r+s.nodeSize;a>t&&((r<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-r),Math.min(s.text.length,e-r)):s.cut(Math.max(0,t-r-1),Math.min(s.content.size,e-r-1))),n.push(s),o+=s.nodeSize),r=a}return new f(n,o)}cutByIndex(t,e){return t==e?f.empty:0==t&&e==this.content.length?this:new f(this.content.slice(t,e))}replaceChild(t,e){let n=this.content[t];if(n==e)return this;let o=this.content.slice(),i=this.size+e.nodeSize-n.nodeSize;return o[t]=e,new f(o,i)}addToStart(t){return new f([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new f(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,n=0;e<this.content.length;e++){let o=this.content[e];t(o,n,e),n+=o.nodeSize}}findDiffStart(t,e=0){return h(this,t,e)}findDiffEnd(t,e=this.size,n=t.size){return m(this,t,e,n)}findIndex(t,e=-1){if(0==t)return x(0,t);if(t==this.size)return x(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let n=0,o=0;;n++){let i=o+this.child(n).nodeSize;if(i>=t)return i==t||e>0?x(n+1,i):x(n,o);o=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((t=>t.toJSON())):null}static fromJSON(t,e){if(!e)return f.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new f(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return f.empty;let e,n=0;for(let o=0;o<t.length;o++){let i=t[o];n+=i.nodeSize,o&&i.isText&&t[o-1].sameMarkup(i)?(e||(e=t.slice(0,o)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new f(e||t,n)}static from(t){if(!t)return f.empty;if(t instanceof f)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new f([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}f.empty=new f([],0);const g={index:0,offset:0};function x(t,e){return g.index=t,g.offset=e,g}class S{constructor(t,e,n){this.content=t,this.openStart=e,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let n=v(this.content,t+this.openStart,e);return n&&new S(n,this.openStart,this.openEnd)}removeBetween(t,e){return new S(w(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return S.empty;let n=e.openStart||0,o=e.openEnd||0;if("number"!=typeof n||"number"!=typeof o)throw new RangeError("Invalid input for Slice.fromJSON");return new S(f.fromJSON(t,e.content),n,o)}static maxOpen(t,e=!0){let n=0,o=0;for(let o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(let n=t.lastChild;n&&!n.isLeaf&&(e||!n.type.spec.isolating);n=n.lastChild)o++;return new S(t,n,o)}}function w(t,e,n){let{index:o,offset:i}=t.findIndex(e),r=t.maybeChild(o),{index:s,offset:a}=t.findIndex(n);if(i==e||r.isText){if(a!=n&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(o,r.copy(w(r.content,e-i-1,n-i-1)))}function v(t,e,n,o){let{index:i,offset:r}=t.findIndex(e),s=t.maybeChild(i);if(r==e||s.isText)return o&&!o.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=v(s.content,e-r-1,n);return a&&t.replaceChild(i,s.copy(a))}S.empty=new S(f.empty,0,0);class y{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},n){n||(n=O(e).createDocumentFragment());let o=n,i=[];return t.forEach((t=>{if(i.length||t.marks.length){let n=0,r=0;for(;n<i.length&&r<t.marks.length;){let e=t.marks[r];if(this.marks[e.type.name]){if(!e.eq(i[n][0])||!1===e.type.spec.spanning)break;n++,r++}else r++}for(;n<i.length;)o=i.pop()[1];for(;r<t.marks.length;){let n=t.marks[r++],s=this.serializeMark(n,t.isInline,e);s&&(i.push([n,o]),o.appendChild(s.dom),o=s.contentDOM||s.dom)}}o.appendChild(this.serializeNodeInner(t,e))})),n}serializeNodeInner(t,e){let{dom:n,contentDOM:o}=y.renderSpec(O(e),this.nodes[t.type.name](t));if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,o)}return n}serializeNode(t,e={}){let n=this.serializeNodeInner(t,e);for(let o=t.marks.length-1;o>=0;o--){let i=this.serializeMark(t.marks[o],t.isInline,e);i&&((i.contentDOM||i.dom).appendChild(n),n=i.dom)}return n}serializeMark(t,e,n={}){let o=this.marks[t.type.name];return o&&y.renderSpec(O(n),o(t,e))}static renderSpec(t,e,n=null){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;let o,i=e[0],r=i.indexOf(" ");r>0&&(n=i.slice(0,r),i=i.slice(r+1));let s=n?t.createElementNS(n,i):t.createElement(i),a=e[1],l=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a)){l=2;for(let t in a)if(null!=a[t]){let e=t.indexOf(" ");e>0?s.setAttributeNS(t.slice(0,e),t.slice(e+1),a[t]):s.setAttribute(t,a[t])}}for(let i=l;i<e.length;i++){let r=e[i];if(0===r){if(i<e.length-1||i>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}{let{dom:e,contentDOM:i}=y.renderSpec(t,r,n);if(s.appendChild(e),i){if(o)throw new RangeError("Multiple content holes");o=i}}}return{dom:s,contentDOM:o}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new y(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=E(t.nodes);return e.text||(e.text=t=>t.text),e}static marksFromSchema(t){return E(t.marks)}}function E(t){let e={};for(let n in t){let o=t[n].spec.toDOM;o&&(e[n]=o)}return e}function O(t){return t.document||window.document}function z(t,e,n){const{state:o}=t,i=[];return o.doc.nodesBetween(e,n,((e,n,r)=>{if(r===o.doc){const n=y.fromSchema(t.schema).serializeNode(e),o=document.createElement("div");o.appendChild(n),i.push(o.innerHTML)}})),i.join("")}const T=async({action:t,text:e,textOptions:n,extensionOptions:o})=>{var i,r;const{appId:s,token:a,baseUrl:l}=o,c=null!=l?l:b,d=await fetch(`${c}/text/${t}`,{method:"POST",headers:{accept:"application/json","content-type":"application/json","X-App-Id":s,Authorization:`Bearer ${a}`},body:JSON.stringify({...n,text:e})}),p=await d.json();if(!d.ok){if((null==p?void 0:p.error)instanceof Object)throw new Error(`${null===(i=null==p?void 0:p.error)||void 0===i?void 0:i.status} ${null===(r=null==p?void 0:p.error)||void 0===r?void 0:r.message}`);throw new Error(`${null==p?void 0:p.error} ${null==p?void 0:p.message}`)}return null==p?void 0:p.response},M=({props:t,action:e,textOptions:n,extensionOptions:o,fetchDataFn:i})=>async()=>{const{editor:r}=t,{state:s}=r,a={collapseToEnd:!0,plainText:!1,...n},{selection:l,selection:{from:c,to:d}}=s,p=(null==n?void 0:n.text)||(a.plainText?s.doc.textBetween(c,d," "):z(r,c,d));if(!p)return!1;o.onLoading&&o.onLoading();let h=c;a.append&&(h=d);try{const t=await i({action:e,text:p,textOptions:n,extensionOptions:o,defaultResolver:T});return a.append||r.chain().focus().deleteRange(l).run(),r.chain().focus().insertContentAt(h,t).command((({dispatch:t,tr:e})=>!(!o.collapseToEnd&&!a.collapseToEnd)||u({dispatch:t,tr:e,oldSelection:l}))).run(),o.onSuccess&&o.onSuccess(),!0}catch(t){return o.onError&&o.onError(t),!1}},A=(t,e,n)=>{const{editor:o}=t,{stream:i=!1}=n,r=o.extensionManager.extensions.find((t=>"ai"===t.name||"aiAdvanced"===t.name));if(!r)return!1;const{baseUrl:s}=r.options;return(()=>{if(!window)return!0;const{location:t}=window,{hostname:e}=t;return!["localhost","tiptap.dev","embed-pro.tiptap.dev","ai-demo.tiptap.dev","demos.tiptap.dev","demo-pitch.tiptap.dev"].includes(e)})()&&s===I&&console.warn("[tiptap-ai] You’re using our demo AI endpoint. This is highly discouraged in your own projects and may break things.\n\nPlease register an account at https://tiptap.dev"),i?p({props:t,action:e,textOptions:n,extensionOptions:r.options,fetchDataFn:d,defaultResolver:d})():M({props:t,action:e,textOptions:n,extensionOptions:r.options,fetchDataFn:T,defaultResolver:T})()},k=async({text:t,imageOptions:e,extensionOptions:n})=>{var o,i;const{appId:r,token:s,baseUrl:a}=n,l=null!=a?a:b,c=await fetch(`${l}/image/prompt`,{method:"POST",headers:{accept:"application/json","content-type":"application/json","X-App-Id":r,Authorization:`Bearer ${s}`},body:JSON.stringify({...e,text:t})});if(!c.ok){const t=await c.json();if((null==t?void 0:t.error)instanceof Object)throw new Error(`${null===(o=null==t?void 0:t.error)||void 0===o?void 0:o.status} ${null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.message}`);throw new Error(`${null==t?void 0:t.error} ${null==t?void 0:t.message}`)}const d=await c.json();return null==d?void 0:d.response},C=({props:t,imageOptions:e,extensionOptions:n,fetchDataFn:o})=>async()=>{var i;const{editor:r}=t,{state:s}=r,{selection:{from:a,to:l}}=s,c=null!==(i=null==e?void 0:e.text)&&void 0!==i?i:s.doc.textBetween(a,l," ");n.onLoading&&n.onLoading();try{const t=await o({text:c,imageOptions:e,extensionOptions:n});return r.chain().focus().setImage({src:t,alt:c,title:c}).run(),n.onSuccess&&n.onSuccess(),!0}catch(t){return n.onError&&n.onError(t),!1}},b="https://api.tiptap.dev/v1/ai",I="https://api-demo.tiptap.dev/v1/ai",R=t.Extension.create({name:"ai",addOptions:()=>({appId:"YOUR_APP_ID",token:"YOUR_TOKEN_HERE",baseUrl:b,autocompletion:!1,autocompletionOptions:{inputLength:4e3,trigger:"Tab"},append:!1,collapseToEnd:!0,aiStreamResolver:d,aiCompletionResolver:T,aiImageResolver:k,onLoading:()=>null,onSuccess:()=>null,onError:()=>null}),addExtensions:()=>[i.configure()],addProseMirrorPlugins(){var e,n,o;const i=[];return this.editor.options.injectCSS&&t.createStyleTag("\n.tiptap-ai-suggestion {\n  cursor: pointer;\n  pointer-events: none;\n}\n\n.tiptap-ai-suggestion::after {\n  color: #6B7280;\n  content: attr(data-suggestion);\n  pointer-events: none;\n}\n\n.tiptap-ai-suggestion br:first-child,\n.tiptap-ai-suggestion br:last-child {\n  content: ' ';\n  display: inline;\n}\n",this.editor.options.injectNonce,"ai"),this.options.autocompletion&&i.push(c({editor:this.editor,options:{appId:this.options.appId,token:this.options.token,baseUrl:this.options.baseUrl||b,inputLength:(null===(e=this.options.autocompletionOptions)||void 0===e?void 0:e.inputLength)||4e3,modelName:null===(n=this.options.autocompletionOptions)||void 0===n?void 0:n.modelName,trigger:(null===(o=this.options.autocompletionOptions)||void 0===o?void 0:o.trigger)||"Tab"}})),i},addCommands:()=>({aiAdjustTone:(t,e={})=>n=>A(n,"adjust-tone",{...e,tone:t}),aiComplete:(t={append:!0})=>e=>A(e,"complete",t),aiDeEmojify:(t={})=>e=>A(e,"de-emojify",t),aiExtend:(t={})=>e=>A(e,"extend",t),aiEmojify:(t={})=>e=>A(e,"emojify",t),aiFixSpellingAndGrammar:(t={})=>e=>A(e,"fix-spelling-and-grammar",t),aiRephrase:(t={})=>e=>A(e,"rephrase",t),aiShorten:(t={})=>e=>A(e,"shorten",t),aiSimplify:(t={})=>e=>A(e,"simplify",t),aiSummarize:(t={})=>e=>A(e,"summarize",t),aiTextPrompt:(t={})=>e=>A(e,"prompt",t),aiTldr:(t={})=>e=>A(e,"tldr",t),aiTranslate:(t,e={})=>n=>A(n,"translate",{...e,language:t}),aiImagePrompt:(t={})=>e=>((t,e)=>{var n;const{editor:o,state:i}=t,r=o.extensionManager.extensions.find((t=>"ai"===t.name||"aiAdvanced"===t.name)),{selection:{from:s,to:a}}=i,l=null!==(n=null==e?void 0:e.text)&&void 0!==n?n:i.doc.textBetween(s,a," "),c=o.extensionManager.extensions.find((t=>"image"===t.name));if(!l||!r)return!1;if(!c)throw new Error("[tiptap-ai] Image extension is not loaded.");return C({props:t,text:l,imageOptions:e,extensionOptions:r.options,fetchDataFn:r.options.aiImageResolver})()})(e,t)})});exports.AI_DEFAULT_BASE_URL=b,exports.AI_DEMO_BASE_URL=I,exports.Ai=R,exports.aiCompletionCommand=M,exports.aiImageCommand=C,exports.aiStreamCommand=p,exports.default=R,exports.getHTMLContentBetween=z,exports.resolveAiCompletion=T,exports.resolveAiImage=k,exports.resolveAiStream=d;
